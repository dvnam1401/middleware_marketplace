{% extends 'base.html' %}
{% block content %}
    <h2>S·∫£n ph·∫©m th∆∞∆°ng m·∫°i</h2>
    <div class="product-list">
        {% for product in products %}
            <div class="product-item">
                <!-- H√¨nh ·∫£nh (ch·ªâ l·∫•y ·∫£nh ƒë·∫ßu ti√™n) -->
                <img src="{{ product.images.0 }}" alt="{{ product.name }}" class="product-image">
                
                <!-- Gi√° v√† gi·∫£m gi√° -->
                <div class="price-section">
                    {% if product.discount %}
                        <span class="original-price">{{ product.price }} VNƒê</span>
                        <span class="discount">(-{{ product.discount }}%)</span>
                        <span class="final-price">{{ product.price|add:"-50" }} VNƒê</span>
                    {% else %}
                        <span class="final-price">{{ product.price }} VNƒê</span>
                    {% endif %}
                </div>

                <!-- T√™n s·∫£n ph·∫©m -->
                <div class="product-name">
                    {{ product.name }}
                </div>

                <!-- Chi ti·∫øt th√™m -->
                <div class="product-details">
                    <span class="views">üëÄ {{ product.views|default:"33K" }}</span>
                    <span class="rating">‚≠ê {{ product.rating|default:"0" }} / 5</span>
                </div>

                <!-- N√∫t xem chi ti·∫øt cho s·∫£n ph·∫©m -->
                <button class="detail-button" data-product-id="{{ product.product_id }}">Xem chi ti·∫øt</button>
            </div>
        {% empty %}
            <p>Kh√¥ng c√≥ s·∫£n ph·∫©m</p>
        {% endfor %}
    </div>

    <!-- Ph·∫ßn s√°ch -->
    <h2>S√°ch</h2>
    <div class="product-list">
        {% for book in books %}
            <div class="product-item">
                <!-- H√¨nh ·∫£nh v·ªõi ƒë∆∞·ªùng d·∫´n m·∫∑c ƒë·ªãnh n·∫øu kh√¥ng c√≥ -->
                <img src="https://png.pngtree.com/background/20211216/original/pngtree-photographs-of-books-stacked-on-the-grass-in-the-morning-of-picture-image_1519358.jpg" 
                     alt="{{ book.name }}" 
                     class="product-image">

                <!-- Gi√° -->
                <div class="price-section">
                    <span class="final-price">{{ book.price }}K VNƒê</span>
                </div>

                <!-- T√™n s√°ch -->
                <div class="product-name">
                    {{ book.name }}
                </div>

                <!-- Chi ti·∫øt th√™m -->
                <div class="product-details">
                    <span class="quantity">S·ªë l∆∞·ª£ng: {{ book.quantity }}</span>
                    <span class="rating">‚≠ê {{ book.rating|default:"0" }} / 5</span>
                </div>

                <!-- N√∫t xem chi ti·∫øt cho s√°ch -->
                <button class="book-detail-button" data-product-id="{{ book.product_id }}">Xem chi ti·∫øt</button>
            </div>
        {% empty %}
            <p>Kh√¥ng c√≥ s√°ch</p>
        {% endfor %}
    </div>

    <!-- Ph·∫ßn workout -->
    <div class="workout-section">
        <h2>T·∫°o K·∫ø Ho·∫°ch T·∫≠p Luy·ªán</h2>
        <p>Nh·∫≠p th√¥ng tin c·ªßa b·∫°n ƒë·ªÉ nh·∫≠n k·∫ø ho·∫°ch t·∫≠p luy·ªán c√° nh√¢n h√≥a</p>
        <button class="workout-button" onclick="window.location.href='{% url 'workout_form' %}'">T·∫°o K·∫ø Ho·∫°ch T·∫≠p Luy·ªán</button>
    </div>

    <script>
        // When document is ready
        $(document).ready(function() {
            // Product detail button handling
            $('.detail-button').on('click', function() {
                var productId = $(this).data('product-id');
                window.location.href = '/product/' + productId + '/';
            });
            
            // Book detail button handling
            $('.book-detail-button').on('click', function() {
                var productId = $(this).data('product-id');
                window.location.href = '/book/' + productId + '/';
            });
        });
    </script>
{% endblock %}